(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{143:function(e,t,n){},171:function(e,t,n){},172:function(e,t,n){"use strict";n.r(t);var a,r,c,o=n(1),l=n(0),i=n.n(l),u=n(12),m=n.n(u),s=n(50),d=n.n(s),p=n(25),f=n(3),j=n(24),b=n.n(j),E=n(51),v=n(4),y=n(26),h=n.n(y),O=n(27),g=n.n(O),P=n(2),S=n.n(P),w=n(9),C=n.n(w),k="imageCollection",x="prose",N=[k,x,"motion"],I=["moodBoard","storyBoard","styleFrames"],L=(a={},Object(v.a)(a,x,x),Object(v.a)(a,"motion","motion"),Object(v.a)(a,k,["moodBoard","storyBoard","styleFrames"]),a),A=(r={},Object(v.a)(r,k,"Image collection"),Object(v.a)(r,x,"Script"),Object(v.a)(r,"motion","Animation"),r),R=(c={},Object(v.a)(c,"moodBoard","Mood board"),Object(v.a)(c,"storyBoard","Story board"),Object(v.a)(c,"styleFrames","Style frames"),c),B=S.a.oneOf(N),D=S.a.oneOf(I),U=S.a.shape({id:S.a.string,name:S.a.string,type:B.isRequired,subtype:D}),_=(S.a.shape({name:S.a.string,sections:S.a.arrayOf(U)}),{overviewLink:"Overview"}),F=[{id:C()("Script"),name:"Script",type:x},{id:C()("Mood board"),name:"Mood board",type:k,subtype:"moodBoard"},{id:C()("Story board"),name:"Story board",type:k,subtype:"storyBoard"},{id:C()("Style frames"),name:"Style frames",type:k,subtype:"styleFrames"},{id:C()("Animation"),name:"Animation",type:"motion"}];var M,T=(M="projects","".concat("anni-pma-").concat(M)),J=[],W=function(){var e=Object(E.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.getItem(T);case 3:if(t=e.sent){e.next=8;break}return e.next=7,g.a.setItem(T,J);case 7:return e.abrupt("return",J);case 8:return e.abrupt("return",t);case 11:e.prev=11,e.t0=e.catch(0);case 13:case"end":return e.stop()}},e,null,[[0,11]])}));return function(){return e.apply(this,arguments)}}();function H(e){if(e)return g.a.setItem(T,e)}var q=p.a,z=d()({clientId:"swbiv6r9kwfs4os",authRedirect:q}),G=(z.DropboxContext,z.DropboxProvider),V=z.useDropboxClient;function $(e){var t=e.children;return i.a.createElement(G,null,t)}n(143);var K=n(5),Q=n(7),X=function(e){var t="/project-manager-application";return"/"===e?"".concat(t,"/"):"".concat(t,"/").concat(e,"/")},Y={projectNameLabel:"Project name",projectNamePlaceholder:"Project B",noProjects:"No projects",createProject:"Create project",removeProject:"Remove project",removeProjectAriaLabel:"Remove {name} project",errorProjectNameTaken:"Sorry, that project name is already taken."},Z=function(e){return Y.removeProjectAriaLabel.replace(/\{.*?\}/,e)};function ee(e){var t=e.id,n=e.name,a=e.removeProject;return i.a.createElement("div",null,i.a.createElement("h3",null,i.a.createElement(Q.a,{to:X(t)},n)),i.a.createElement("button",{"aria-label":Z(n),onClick:function(){return a(n)}},Y.removeProject))}var te="projectNameErrorId";function ne(e){var t=e.addProject,n=e.validateProject,a=Object(l.useState)(""),r=Object(o.a)(a,2),c=r[0],u=r[1],m=Object(l.useState)(null),s=Object(o.a)(m,2),d=s[0],p=s[1];return i.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),c){var a,r=(a=c,{id:C()(a),name:a,sections:F}),o=n(r);null===o?(t(r),u("")):p(o)}}},i.a.createElement("label",{htmlFor:"projectName"},Y.projectNameLabel,i.a.createElement("input",{"aria-describedby":d&&te,"aria-invalid":!!d||null,id:"projectName",type:"text",className:"input",placeholder:Y.projectNamePlaceholder,value:c,onChange:function(e){p(null),u(e.target.value)}})),d&&i.a.createElement("p",{style:{color:"magenta"},id:te},d.message),i.a.createElement("button",{type:"submit"},Y.createProject))}function ae(e){var t=e.projects,n=e.setProjects,a=function(e){return n(t.filter(function(t){return t.name!==e}))};return i.a.createElement("div",null,i.a.createElement("h2",null,"Projects"),0===t.length&&i.a.createElement("p",null,Y.noProjects),t.map(function(e){return i.a.createElement(ee,Object.assign({},e,{key:e.name,removeProject:a}))}),i.a.createElement(ne,{addProject:function(e){return n([].concat(Object(K.a)(t),[e]))},validateProject:function(e){var n=e.name;return t.find(function(e){return e.name===n})?{message:Y.errorProjectNameTaken}:null}}))}var re=n(53),ce="PROJECT_SECTION",oe="PROJECT_SECTION_NAV",le="404 - Page not found",ie=function(){return i.a.createElement("div",null,i.a.createElement("h1",null,le))},ue=n(14),me=function(){return i.a.createElement("div",null,"Loading...")},se=i.a.lazy(function(){return Promise.all([n.e(2),n.e(4)]).then(n.bind(null,348))});function de(e){return i.a.createElement("div",null,i.a.createElement(l.Suspense,{fallback:i.a.createElement(me,null)},i.a.createElement(se,e)))}var pe=n(54),fe=n.n(pe),je=n(15),be=Object(je.SortableHandle)(function(){return i.a.createElement("span",{style:{border:"1px dotted gold",cursor:"grab",padding:8,display:"inline-block"}},":::")}),Ee=Object(je.SortableElement)(function(e){var t=e.renderItem,n=void 0===t?function(){return"feed me"}:t,a=e.value;return i.a.createElement("li",null,i.a.createElement(be,null),"string"===typeof n?a:n(a))}),ve=Object(je.SortableContainer)(function(e){var t=e.items,n=e.listStyle,a=void 0===n?{}:n,r=Object(ue.a)(e,["items","listStyle"]);return i.a.createElement("ul",{style:a},t.map(function(e,t){return i.a.createElement(Ee,Object.assign({key:"item-".concat(t),index:t,value:e},r))}))}),ye=["Item 1","Item 2","Item 3","Item 4","Item 5","Item 6"];function he(e){var t=e.axis,n=void 0===t?"y":t,a=e.defaultItems,r=void 0===a?ye:a,c=e.onReorder,u=void 0===c?function(){return null}:c,m=Object(ue.a)(e,["axis","defaultItems","onReorder"]),s=Object(l.useState)(r),d=Object(o.a)(s,2),p=d[0],f=d[1];Object(l.useEffect)(function(){var e=fe()(r,p);e.length>0&&f([].concat(Object(K.a)(p),Object(K.a)(e)))});return i.a.createElement(ve,Object.assign({},m,{axis:n,items:p,onSortEnd:function(e){var t=e.oldIndex,n=e.newIndex,a=Object(je.arrayMove)(p,t,n);u(a),f(a)},useDragHandle:!0}))}function Oe(e){var t=e.file,n=e.url,a=e.preview,r=e.title,c=e.description;return i.a.createElement("figure",{style:{maxWidth:300,position:"relative"}},i.a.createElement("img",{src:n||a,alt:r||c||t&&t.name,style:{maxWidth:"100%",height:"auto"}}),i.a.createElement("figcaption",null,c))}var ge={display:"flex",flexWrap:"wrap"},Pe="imageCollectionUploadInput";function Se(e){var t=e.defaultCollection,n=void 0===t?[]:t,a=Object(l.useState)(n),r=Object(o.a)(a,2),c=r[0],u=r[1];return i.a.createElement("div",null,c.length>0?i.a.createElement(he,{axis:"xy",defaultItems:c,listStyle:ge,onReorder:u,renderItem:Oe}):i.a.createElement("p",null,"No images."),i.a.createElement("label",{htmlFor:Pe},"Upload image"),i.a.createElement("input",{id:Pe,name:Pe,type:"file",accept:"image/png, image/jpeg",onChange:function(e){var t=e.target.files,n=Object(K.a)(t).map(function(e){return{file:e,preview:URL.createObjectURL&&URL.createObjectURL(e)}});u([].concat(Object(K.a)(c),Object(K.a)(n)))}}))}function we(e){var t=e.updateProjectSection,n=Object(ue.a)(e,["updateProjectSection"]),a=n.id,r=n.name,c=n.project,o=n.subtype,l=n.type,u=Object(f.a)({},n,{save:function(e){return t(c.id,a,e)}});return i.a.createElement("div",{"data-testid":ce},i.a.createElement("h1",null,c.name," - ",r),function(e,t){switch(e){case x:return i.a.createElement(de,t);case k:return i.a.createElement(Se,t);default:return i.a.createElement("div",null,"Section content pending for type: ",e)}}(l,u),o&&" - ".concat(o))}function Ce(e){var t=e.project;return i.a.createElement("div",{"data-testid":ce},i.a.createElement("h1",null,t.name),i.a.createElement("p",null,t.details))}var ke={newProjectSectionNameLabel:"New project section name",newProjectSectionNamePlaceholder:"Section name",saveNewProjectSectionButtonLabel:"Add new project section"},xe="type",Ne="subtype",Ie={name:"",type:k,subtype:"moodBoard"},Le=function(e,t){return e===t.type},Ae=function(e,t){return e===t.subtype},Re=function(e,t){return Object(f.a)({},e,t)};function Be(e){var t=e.saveNewSection,n=Object(l.useReducer)(Re,Ie),a=Object(o.a)(n,2),r=a[0],c=a[1],u=function(e){return c({subtype:e})};return i.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(Object(f.a)({},r,{id:C()(r.name)})),c(Ie)}},i.a.createElement("label",null,ke.newProjectSectionNameLabel,i.a.createElement("input",{value:r.name,onChange:function(e){var t,n=e.target;return t=n.value,c({name:t})},name:"newProjectSectionName",placeholder:ke.newProjectSectionNamePlaceholder})),i.a.createElement("ul",null,Object.entries(L).map(function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return i.a.createElement("li",{key:n},i.a.createElement("label",null,i.a.createElement("input",{checked:Le(n,r),type:"radio",name:xe,onChange:function(){return function(e){c({type:e}),u(Array.isArray(L[e])?L[e][0]:null)}(n)},value:n}),A[n]),Le(n,r)&&Array.isArray(a)&&i.a.createElement("ul",null,a.map(function(e){return i.a.createElement("li",{key:e},i.a.createElement("label",null,i.a.createElement("input",{checked:Ae(e,r),type:"radio",name:Ne,onChange:function(){return u(e)},value:n}),R[e]))})))})),i.a.createElement("button",{type:"submit"},ke.saveNewProjectSectionButtonLabel))}var De={cancel:"Cancel",saveChanges:"Save Changes"};function Ue(e){var t=e.project,n=e.updateProject,a=e.toggleEditing,r=Object(l.useState)(t),c=Object(o.a)(r,2),u=c[0],m=c[1],s=u.sections;return i.a.createElement("div",null,i.a.createElement(he,{defaultItems:s,onReorder:function(e){return m(Object(f.a)({},t,{sections:e}))},renderItem:function(e){var t=e.name;return i.a.createElement("strong",null,t)}}),i.a.createElement(Be,{project:u,saveNewSection:function(e){m({id:t.id,sections:[].concat(Object(K.a)(s),[e])})}}),i.a.createElement("button",{onClick:function(){n(u),a()}},De.saveChanges),i.a.createElement("button",{onClick:a},De.cancel))}var _e=Object(re.a)(function(e){return e.projects},function(e){return e.projectId},function(e,t){return e.find(function(e){return e.id===t})});function Fe(e){var t=Object(l.useState)(!1),n=Object(o.a)(t,2),a=n[0],r=n[1],c=_e(e),u=e.updateProject,m=e.updateProjectSection;if(!c)return i.a.createElement(ie,null);var s=i.a.createElement("ul",{"data-testid":oe},i.a.createElement("li",null,i.a.createElement(Q.a,{to:"./"},_.overviewLink)),c.sections.map(function(e,t){var n=e.id,a=e.name;return i.a.createElement("li",{key:n},i.a.createElement(Q.a,{to:n},a))}),i.a.createElement("li",null,i.a.createElement("button",{onClick:function(){return r(!0)}},"Edit project sections"))),d=i.a.createElement(Ue,{project:c,toggleEditing:function(){return r(!1)},updateProject:u});return i.a.createElement("div",null,i.a.createElement(Q.b,null,i.a.createElement(Ce,{default:!0,project:c}),c.sections.map(function(e,t){return i.a.createElement(we,Object.assign({key:e.id,path:e.id,project:c,updateProjectSection:m},e))})),a?d:s)}Fe.defaultProps={updateProject:function(){return null}};var Me,Te="abce".split("").map(function(e){return{id:"project-".concat(e),name:"Project ".concat(e.toUpperCase()),details:"Details about project ".concat(e.toUpperCase()),sections:F}}),Je=(n(171),X("/")),We=function(){return i.a.createElement("div",null,"Home")};function He(e){var t=e.client,n=e.authUrl,a=e.logout,r=Object(l.useState)(null),c=Object(o.a)(r,2),u=c[0],m=c[1];return Object(l.useEffect)(function(){t&&(window.history.pushState("",document.title,window.location.pathname+window.location.search),t.usersGetCurrentAccount().then(m))},[]),t?u?i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("h2",null,u.name.familiar_name),i.a.createElement("img",{style:{borderRadius:"50%"},with:50,height:50,src:u.profile_photo_url,alt:u.name.display_name}),i.a.createElement("button",{onClick:a},"Logout"))):i.a.createElement(me,null):i.a.createElement("a",{href:n},"Login to Dropbox")}function qe(e){var t=e.defaultProjects,n=void 0===t?Te:t,a=Object(l.useState)(!1),r=Object(o.a)(a,2),c=r[0],u=r[1],m=V(),s=m.client,d=m.updateDatabase;Me=n;var j=Object(l.useState)(n),b=Object(o.a)(j,2),E=b[0],v=b[1];function y(e){v(E.map(function(t){return t.id===e.id?Object(f.a)({},t,e):t}))}return Object(l.useEffect)(function(){s||(window.location.href=p.a)},[s]),Object(l.useEffect)(function(){s&&!h()(Me,E)&&(H(E),d({data:{projects:E}}),Me=E)}),i.a.createElement("div",{className:"App"},i.a.createElement("header",null,"Anni Project Manager Application",i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(Q.a,{to:Je},"Home")),s&&i.a.createElement("li",null,i.a.createElement(Q.a,{to:X("dashboard")},"Dashboard")),i.a.createElement("li",null,i.a.createElement(He,m)))),i.a.createElement(Q.b,null,i.a.createElement(We,{path:X("/")}),i.a.createElement(ae,{path:X("dashboard"),projects:E,setProjects:v}),i.a.createElement(Fe,{path:X(":projectId/*"),projects:E,updateProject:y,updateProjectSection:function(e,t,n){var a=E.find(function(t){return t.id===e}),r=a.sections.find(function(e){return e.id===t});a&&r&&(console.log("project",a),console.log("updateProjectSection",e,t,r),y(Object(f.a)({},a,{sections:a.sections.map(function(e){return delete e.editorContent,e.id===t?Object(f.a)({},e,n):e})})))}}),i.a.createElement(ie,{default:!0})),i.a.createElement("footer",{style:{padding:"100px 20px",background:"MintCream",float:"right"}},i.a.createElement("button",{onClick:function(){return u(!c)}},"Debug State"),c&&i.a.createElement("pre",{style:{background:"lavender",padding:10}},JSON.stringify(E,null,2))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ze=document.getElementById("root");function Ge(e){var t=e.children;return i.a.createElement("div",{className:"PresentationPanel"},t)}function Ve(){var e=V().authUrl;return i.a.createElement(Ge,null,i.a.createElement("div",null,i.a.createElement("h1",null,"Anni"),i.a.createElement("a",{href:e},"Login with Dropbox")))}m.a.render(i.a.createElement($,null,i.a.createElement(function(){var e=V(),t=e.client,n=e.readDatabase,a=Object(l.useState)(null),r=Object(o.a)(a,2),c=r[0],u=r[1];return Object(l.useEffect)(function(){t&&n().then(function(e){e?u(e.projects):W().then(u)})},[]),t?c?i.a.createElement($,null,i.a.createElement(qe,{defaultProjects:c})):i.a.createElement(Ge,null,i.a.createElement(me,null)):i.a.createElement(Ve,null)},null)),ze),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},25:function(e){e.exports={a:"https://anni.io/project-manager-application"}},56:function(e,t,n){e.exports=n(172)}},[[56,1,3]]]);
//# sourceMappingURL=main.ac0759ee.chunk.js.map